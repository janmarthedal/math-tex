<link rel="import" href="mathjax-loader.html">

<!--
Typesets math written in (La)TeX, using [MathJax](http://mathjax.org).

##### Example

    <math-tex>c = \sqrt{a^2 + b^2}</math-tex>

##### Example

    <math-tex mode="display">\sum_{k=1}^n k = \frac{n (n + 1)}{2}</math-tex>

@element math-tex
@status alpha
@homepage http://github.com/janmarthedal/math-tex/
-->
<script>
(function() {
    var element = Object.create(HTMLElement.prototype);

    element.createdCallback = function () {
        var shadow = this.createShadowRoot();
        var mathjax_loader = document.createElement('mathjax-loader');
        var script = document.createElement('script');
        shadow.appendChild(mathjax_loader);
        shadow.appendChild(script);
        this._private = {
            mathjax: mathjax_loader,
            script: script
        };
    };

    element.attachedCallback = function () {
        this._private.script.type = "math/tex";
        if (this.getAttribute('mode') === 'display') {
            this._private.script.type += "; mode=display";
        }
        this._private.script.textContent = this.textContent;
        this._private.mathjax.typeset(this._private.script);
    };

    document.registerElement('math-tex', {prototype: element});
}());
</script>
